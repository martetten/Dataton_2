# Gradient Seekers
Всем привет! Наша команда Gradient Seekers, и мы подготовили проект по теме «Тематическая классификация текстов»

## Задача «Тематическая классификация текстов»

## Цель и задачи
**Цель проекта** —  создание системы, которая определяет вероятность принадлежности текста к одной или нескольким тематикам из заданного списка.


**Задачи проекта**:   
1. Решить задачу классификации с пересекающимися классами. Разработать и обучить модель машинного обучения, способную анализировать текст и предсказывать вероятности его принадлежности к одной или нескольким тематикам.
2. Создать пользовательский интерфейс, который принимает текст на вход, отправляет его на классификацию и возвращает категорию, к которой относится текст.

## Описание данных 
Весь набор данных взят из соцсетей в исходном виде. Он состоит из 6 датасетов (каждый датасет - отдельный класс) 

Каждая строка файла - это некоторый пост из соцсети. Пост может содержать исходный текст (то, что написал сам пользователь), текст на картинке, текст речи из видео. Поэтому файл имеет 3 колонки, разделенные знаком ",".

Колонка `doc_text` содержит исходный текст самого поста.
Колонка `image2text` содержит текст, распознанный на изображении поста с помощью системы OCR.
Колонка `speech2text` содержит текст речи, распознанной с помощью системы ASR .

Некоторые посты могут не иметь те или иные поля, т.е. содержат пустой текст.

Классы (тематики текстов): спорт, юмор, реклама, соцсети, политика, личная жизнь.

## Описание модели

[`DeepPavlov/rubert-base-cased`](https://huggingface.co/DeepPavlov/rubert-base-cased) - это языковая модель на основе BERT, разработанная DeepPavlov и обученная на русской части Википедии и новостных данных. 

Основные плюсы модели:
- Высокое качество благодаря архитектуре BERT
- Поддержка контекстного понимания текста  (учитывает семантику слов в предложении, а не только их отдельные значения)
- Оптимизация для русского языка (она более эффективная для русского языка по сравнению с мультиязычными BERT-моделями)
- Поддержка токенизации с учётом регистра (cased)

## Реализация проекта
**Стек технологий**:  
- Python
- PyTorch
- Docker
- Flask
- HTML, CSS, JS
- Bootstrap


**Этапы работы:**
1. Предобработка данных (очистка, токенизация), EDA
2. Оценка распределения данных по классам, проверка кластеризации
3. Классификация методами классического МО
4. single-label классификация с помощью RuBERT модели
5. multi-label классификация с помощью RuBERT модели
6. Предсказание на тестовых данных
7. Разработка UI интерфейса и Flask приложения
8. Тестирование

## Инструкция для запуска

!!!__**Предварительно необходимо добавить модели обученные в результате выполнения
скрипта [bert_train_test.py](src%2Fscripts%2Fbert_train_test.py) или ноутбука [bert_train_test.ipynb](notebooks%2Fbert_train_test.ipynb) в папку models**__ !!!

### I. Запуск приложения
#### Вариант 1

Находясь в корневой директории проекта 

Создать виртуальное окружение

```bash
python -m venv .venv
```

Активировать виртуальное окружение (Пример активации для linux)
```bash
source .venv/bin/activate
```

Для Windows

```bash
.venv/Scripts/activate
```


Установить зависимости
```bash
pip install -r requirements.txt
```
Запустить Flask приложения  

```bash
 python -m src.app.app

```
#### Вариант 2

Поднять контейнер с приложением
```bash
docker compose up -d
```
### II. Запуск скриптов

Находясь в корневой директории проекта 

Создать виртуальное окружение

```bash
python -m venv .venv
```

Активировать виртуальное окружение (Пример активации для linux)
```bash
source .venv/bin/activate
```

Для Windows

```bash
.venv/Scripts/activate
```


Установить зависимости
```bash
pip install -r requirements.txt
```
Все скрипты лежат в папке src/scripts

Для запуска скрипта через CLI необходимо из корневой директории проекта ввести команду

```bash
cd src/scripts
python <Название файла>
```

### Описание скриптов

[Dataton2_GradSeekers_EDA.py](src%2Fscripts%2FDataton2_GradSeekers_EDA.py) - Скрипт подготовки датасета и проведения разведочного анализа (EDA).

[Dataton2_GradSeekers_Classic_models.py](src%2Fscripts%2FDataton2_GradSeekers_Classic_models.py) - Скрипт подготовки датасета и обучения на нем
классических моделей машинного обучения (Logistic Regression, Random Forest, SVM) для целей классификации. По итогам обучения в папке models появляются необходимые 
модели.

[Dataton2_GradSeekers_SL_BERT.py](src%2Fscripts%2FDataton2_GradSeekers_SL_BERT.py) - Скрипт подготовки датасета и обучения на нем
модели RuBERT для целей single label классификации (с возможностью выводить топ 2 вероятности). По итогам обучения в папке models появляются необходимые 
модели.

[bert_train_test.py](src%2Fscripts%2Fbert_train_test.py) - Скрипт подготовки датасета и обучения на нем финальной модели RuBERT для целей мультиметочной классификации. По итогам обучения в папке models появляются необходимые 
модели для запуска приложения.


## Результат
Приложение с использованием предобученной модели машинного обучения (bert_train_test), которое дает возможность пользователю определить тематику введенного текста (от 2 до 30 слов): спорт, юмор, реклама, соцсети, политика, личная жизнь.

## Возможности развития проекта
1. Улучшение модели классификации
    - Увеличение датасета, расширение спектра категорий
    - Использование альтернативных моделей вместо DeepPavlov/rubert-base-cased для повышения точности (Например, DeepPavlov/rubert-large-cased, ai-forever/ruRoberta-large)
    - Дообучение модели на специфичных данных (создать размеченный датасет)


2. Улучшение UI/UX
    - Сохранение истории запросов и добавление возможности экспорта результатов (CSV или JSON)
    - Визуализация уверенности модели (графики, heatmap по темам)


## Команда

Мартынов Артем Васильевич [@martetten](https://github.com/martetten)  
**Team Lead, Data Scientist**  

Бек Владимир Эдуардович  [@VladimirBek](https://github.com/VladimirBek)  
**Data Scientist, App dev** 

Смолякова Евгения Владимировна [@EvgeniaWave](https://github.com/EvgeniaWave)  
**Data Scientist**  

Яровикова Анастасия Сергеевна  [@ynastt](https://github.com/ynastt)  
**Data Scientist, App dev**  

Серов Илья Алексеевич  [@EliSerov](https://github.com/EliSerov)  
**Data Scientist**   

Игнатьева Анастасия Юрьевна [@AnastasiaIgn](https://github.com/AnastasiaIgn)  
**Data Scientist**  





Project Organization
------------

```
Dataton2/
├── docker-compose.yml
├── Dockerfile     
├── README.md
├── .dockerignore
├── .gitignore                  
├── data                         
│   └── raw                      # The original, immutable data dump.
│
├── models                       # Trained and serialized models.
│
├── notebooks                    # Jupyter notebooks.
│
├── requirements.txt             # The requirements file for reproducing the analysis environment.
└── src                          # Source code for use in this project.
    ├── __init__.py              # Makes src a Python module.     
    ├── app                     # Flask app.
    │   ├── static  
    │   │   └── favicon-32x32.png
    │   ├── templates    
    │   │   └── index.html  
    │   └── app.py
    │   └── utils.py     
    │
    ├── scripts              
    │   ├── bert_train_test.py
    │   ├──     
    │   └── 
```


--------

